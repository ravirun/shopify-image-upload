(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{5159:(e,t,l)=>{Promise.resolve().then(l.bind(l,2029))},2029:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>a});var o=l(5155),s=l(2115);let a=()=>{let[e,t]=(0,s.useState)([]),[l,a]=(0,s.useState)(""),[r,n]=(0,s.useState)(new Set),[i,d]=(0,s.useState)("title"),[c,p]=(0,s.useState)([]),[u,h]=(0,s.useState)(null),[f,m]=(0,s.useState)(null);(0,s.useEffect)(()=>{{let e=sessionStorage.getItem("shopifyStoreUrl"),t=sessionStorage.getItem("shopifyApiKey");e&&t?(h(e),m(t)):a("Please connect your Shopify store first.")}},[]);let b=async()=>{if(!u||!f)return a("Please provide Shopify Store URL and API Key.");if(0===e.length)return console.log("No folders selected."),a("No folders selected.");a("Uploading folders..."),console.log("Preparing form data for upload");let t=new FormData,l={};e.forEach(e=>{let t=e.webkitRelativePath.split("/")[0];if(!e.type.startsWith("image/")){console.log("Skipping non-image file: ".concat(e.name));return}l[t]||(l[t]=[]),l[t].push(e),console.log("Appending file: ".concat(e.webkitRelativePath," to folder: ").concat(t))}),Object.keys(l).forEach(e=>{l[e].sort((e,t)=>{let l=e=>{let t=e.split(".")[0].match(/\d+/);return t?parseInt(t[0],10):NaN},o=l(e.name),s=l(t.name);return isNaN(o)||isNaN(s)?isNaN(o)?1:isNaN(s)?-1:0:s-o})}),Object.keys(l).forEach(e=>{l[e].forEach(l=>{t.append("".concat(e,"/").concat(l.name),l)})}),t.append("storeUrl",u),t.append("apiKey",f),t.append("apiOption",i),console.log("Sending upload request to /api/upload/".concat(i));let o=await fetch("/api/upload/".concat(i),{method:"POST",body:t}),s=await o.json();o.ok?(a("Folders uploaded successfully."),console.log("Upload successful:",s),console.log(s.folderUploads)):(a("Upload failed: ".concat(s.error)),console.error("Upload failed:",s.error))},g=l=>{let o=new Set(r);o.delete(l);let s=e.filter(e=>!e.webkitRelativePath.startsWith(l));n(o),t(s),console.log("Deleted folder: ".concat(l))};return(0,o.jsx)("div",{className:"container mx-auto p-8",children:(0,o.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,o.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Shopify Folder Upload Tool"}),(0,o.jsx)("input",{type:"file",webkitdirectory:"true",multiple:!0,onChange:e=>{let l=Array.from(e.target.files);t(e=>[...e,...l]);let o=new Set([...r]);l.forEach(e=>{let t=e.webkitRelativePath.split("/")[0];o.add(t)}),n(o),console.log("Files selected:",l),console.log("Selected folders:",Array.from(o))},className:"block w-full border border-gray-300 rounded p-2 mb-4"}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsx)("label",{htmlFor:"apiOption",className:"block text-sm font-medium mb-1",children:"Upload by:"}),(0,o.jsxs)("select",{id:"apiOption",value:i,onChange:e=>d(e.target.value),className:"block w-full border border-gray-300 rounded p-2",children:[(0,o.jsx)("option",{value:"title",children:"Title"}),(0,o.jsx)("option",{value:"sku",children:"SKU"}),(0,o.jsx)("option",{value:"id",children:"ID"})]})]}),(0,o.jsx)("button",{onClick:b,className:"bg-blue-600 text-white rounded py-2 px-4 hover:bg-blue-700 transition",children:"Upload Folders"}),(0,o.jsx)("p",{className:"mt-4 text-gray-700",children:l}),(0,o.jsxs)("div",{className:"mt-6",children:[(0,o.jsx)("h3",{className:"text-lg font-semibold",children:"Selected Folders:"}),(0,o.jsx)("ul",{className:"list-disc pl-6",children:[...r].map((e,t)=>(0,o.jsxs)("li",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{children:e}),(0,o.jsx)("button",{onClick:()=>g(e),className:"ml-4 bg-red-500 text-white rounded px-2 py-1 hover:bg-red-600 transition",children:"Delete"})]},t))})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(5159)),_N_E=e.O()}]);