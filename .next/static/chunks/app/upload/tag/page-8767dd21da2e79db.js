(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{3666:(e,t,s)=>{Promise.resolve().then(s.bind(s,4394))},6046:(e,t,s)=>{"use strict";var r=s(6658);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},4394:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),a=s(2115),o=s(6046);let l=()=>{let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(""),[i,d]=(0,a.useState)(""),[n,h]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=sessionStorage.getItem("shopifyStoreUrl"),t=sessionStorage.getItem("shopifyApiKey");e&&d(e),t&&h(t)},[]);let p=async()=>{if(!i||!n){c("Please provide Shopify Store URL and API Key.");return}o(!0),c("Fetching products from Shopify...");try{let e=await fetch("/api/fetch-shopify-products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeUrl:i,apiKey:n})}),s=await e.json();e.ok?(t(s.products),c("Successfully fetched ".concat(s.products.length," products."))):c("Failed to fetch products: ".concat(s.error))}catch(e){c("Error fetching products: ".concat(e.message))}finally{o(!1)}};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("p",{children:l}),(0,r.jsx)("button",{onClick:p,className:"bg-green-600 text-white rounded py-2 px-4 hover:bg-green-700 transition mt-4",children:"Fetch Products"}),s?(0,r.jsx)("p",{className:"mt-4",children:"Loading Shopify products..."}):e.length>0?(0,r.jsxs)("div",{className:"mt-6 overflow-x-auto",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Shopify Products:"}),(0,r.jsxs)("table",{className:"min-w-full border-collapse border border-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"#"}),(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Title"}),(0,r.jsx)("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Tags"})]})}),(0,r.jsx)("tbody",{children:e.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:t+1}),(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.title}),(0,r.jsx)("td",{className:"border border-gray-200 px-4 py-2",children:e.tags.length>0?e.tags.join(", "):"No Tags"})]},t))})]})]}):(0,r.jsx)("p",{className:"mt-4",children:"No products to display."})]})},c=()=>{let[e,t]=(0,a.useState)([]),[s,c]=(0,a.useState)(""),[i,d]=(0,a.useState)(new Set),[n,h]=(0,a.useState)(null),[p,u]=(0,a.useState)(null),g=(0,o.useRouter)();(0,a.useEffect)(()=>{{let e=sessionStorage.getItem("shopifyStoreUrl"),t=sessionStorage.getItem("shopifyApiKey");e&&t?(h(e),u(t)):(c("Redirecting to the home page..."),g.push("/"))}},[g]);let y=async()=>{if(!n||!p)return c("Please provide Shopify Store URL and API Key.");if(0===e.length)return c("No folders selected.");c("Checking product by tag...");let t={};e.forEach(e=>{let s=e.webkitRelativePath.split("/")[0];t[s]||(t[s]=[]),t[s].push(e)});let s=Object.keys(t);try{let e=await fetch("/api/check-tag/tag",{method:"POST",body:JSON.stringify({folderNames:s,storeUrl:n,apiKey:p}),headers:{"Content-Type":"application/json"}}),r=await e.json();e.ok?(c("Tag found. Uploading folders..."),await f(t)):c("Tag not found: ".concat(r.error))}catch(e){c("Error checking tag: ".concat(e.message))}},f=async e=>{let t=new FormData;Object.keys(e).forEach(s=>{e[s].forEach(e=>{t.append("".concat(s,"/").concat(e.name),e)})}),t.append("shopifyStoreUrl",n),t.append("shopifyApiKey",p);try{let e=await fetch("/api/upload/tag",{method:"POST",body:t}),s=await e.json();e.ok?c("Folders uploaded successfully."):c("Upload failed: ".concat(s.error))}catch(e){c("Error uploading folders: ".concat(e.message))}},m=s=>{let r=new Set(i);r.delete(s);let a=e.filter(e=>!e.webkitRelativePath.startsWith(s));d(r),t(a)};return(0,r.jsx)("div",{className:"container mx-auto p-8",children:(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Shopify Folder Upload Tool"}),(0,r.jsx)("input",{type:"file",webkitdirectory:"true",multiple:!0,onChange:e=>{let s=Array.from(e.target.files);t(e=>[...e,...s]);let r=new Set([...i]);s.forEach(e=>{let t=e.webkitRelativePath.split("/")[0];r.add(t)}),d(r)},className:"block w-full border border-gray-300 rounded p-2 mb-4"}),(0,r.jsx)("button",{onClick:y,className:"bg-blue-600 text-white rounded py-2 px-4 hover:bg-blue-700 transition",children:"Upload Folders"}),(0,r.jsx)("p",{className:"mt-4 text-gray-700",children:s}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Selected Folders:"}),(0,r.jsx)("ul",{className:"list-disc pl-6",children:[...i].map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:e}),(0,r.jsx)("button",{onClick:()=>m(e),className:"ml-4 bg-red-500 text-white rounded px-2 py-1 hover:bg-red-600 transition",children:"Delete"})]},t))})]}),n&&p&&(0,r.jsx)(l,{storeUrl:n,apiKey:p})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(3666)),_N_E=e.O()}]);